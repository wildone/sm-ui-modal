<link rel="import" href="../polymer/polymer.html"> <link rel="import" href="../simpla-core/simpla-core.html"> <link rel="import" href="../sm-ui-button/sm-ui-button.html"> <dom-module id="sm-ui-modal"> <template> <style include="sm-css-shady"></style> <style include="sm-css"></style> <style>:host{position:fixed;display:none;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;-ms-grid-row-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;top:0;right:0;bottom:0;left:0;z-index:var(--on-top)}:host([visible]){display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.overlay{position:absolute;top:0;right:0;bottom:0;left:0;background:var(--light-black)}.modal{@apply(--typography);display:inline-block;position:relative;background:#fff;border-radius:var(--border-radius);width:var(--modal-width,auto);height:var(--modal-height,auto);max-width:95%;min-height:300px;min-width:350px;overflow:hidden;box-shadow:0 1px 1px var(--light-black);z-index:1}.modal__banner{padding:24px 40px;background:var(--blue);color:#fff;font-size:34px;text-align:center}.modal__content{padding:40px}.modal__close{position:absolute;top:10px;right:13px;height:auto;color:var(--light-black);--icon-size:14px}.modal__close:hover{color:var(--med-black)}.modal__close[banner]{color:var(--med-white)}.modal__close[banner]:hover{color:var(--bright-white)}:host ::content .modal-action{position:absolute;bottom:20px;right:20px;background:var(--blue);color:#fff;padding:16px 24px;border-radius:var(--border-radius)}</style> <div class="overlay" id="overlay"></div> <div class="modal" id="modal"> <h1 class="modal__banner" hidden$="[[!hasBanner]]">[[title]]</h1> <button is="sm-ui-button" hidden$="[[noExit]]" class="modal__close" id="close" on-tap="close" icon="simpla:cross" banner$="[[hasBanner]]"></button> <div class="modal__content"> <content></content> </div> <content select=".modal-confirm"></content> </div> </template> <script>!function(){"use strict";var e={};e.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var t=simpla.constants.easings,n={observers:["_toggleModal(active)"],_toggleModal:function(e){e?this._openModal():this._closeModal()},get _modalAnimations(){var e=this.$.modal,n=this.$.overlay;return[{target:e,frames:[{transform:"scale(0.75, 0.95)",opacity:0},{transform:"scale(1, 1)",opacity:1}],opts:{open:{easing:t.easeOutCubic,fill:"both",duration:120},close:{easing:t.easeOutCubic,fill:"both",duration:100}}},{target:n,frames:[{opacity:0},{opacity:1}],opts:{open:{easing:"ease",fill:"both",duration:230},close:{fill:"both",duration:170}}}]},_openModal:function(){var e=this;this._modalAnimations.forEach(function(t){var n=t.target,o=t.frames,i=t.opts;e.toggleAttribute("visible",!0),n.animate(o,i.open)})},_closeModal:function(){var e=this;this._modalAnimations.forEach(function(t){var n=t.target,o=t.frames,i=t.opts,a=n.animate(o.reverse(),i.close);a.onfinish=function(){return e.toggleAttribute("visible",!1)}})}},o="modal-confirm",i=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,[{key:"beforeRegister",value:function(){this.is="sm-ui-modal",this.properties={title:String,noExit:Boolean,_hasBanner:{type:Boolean,computed:"_computeHasBanner(title)",value:!1}}}},{key:"_activeChanged",value:function(e){e?this.fire("opened"):this.fire("closed")}},{key:"_computeHasBanner",value:function(e){return!!e}},{key:"open",value:function(){this.active=!0}},{key:"close",value:function(){this.active=!1}},{key:"confirm",value:function(){this.active=!1,this.fire("confirm")}},{key:"getModal",value:function(){return this.$.modal}},{key:"_closeOnConfirm",value:function(){var e=Polymer.dom(this).querySelector("."+o);e&&this.listen(e,"tap","confirm")}},{key:"_closeOnOverlay",value:function(){this.noExit||this.listen(this.$.overlay,"tap","close")}},{key:"_closeOnEscape",value:function(){var e=this;document.addEventListener("keyup",function(t){27===t.keyCode&&e.close()})}},{key:"attached",value:function(){this._closeOnConfirm(),this._closeOnOverlay(),this._closeOnEscape()}},{key:"behaviors",get:function(){return[n,simpla.behaviors.active({observer:"_activeChanged"})]}}]),t}();Polymer(i)}()</script> </dom-module>